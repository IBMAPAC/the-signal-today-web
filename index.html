<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2563eb" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#111827" media="(prefers-color-scheme: dark)">
    <meta name="description" content="AI-powered intelligence briefing for enterprise technology leaders">
    <title>The Signal Today</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üì°</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>üì° The Signal Today</h1>
                <div class="header-actions">
                    <span id="reading-time" class="reading-badge">0/15 min</span>
                    <button id="refresh-btn" class="btn btn-primary" title="Refresh">
                        <span class="refresh-icon">‚Üª</span> Refresh
                    </button>
                    <button id="settings-btn" class="btn btn-secondary" title="Settings">‚öôÔ∏è</button>
                </div>
            </div>
            <div class="header-meta">
                <span id="current-date"></span>
                <span id="last-updated"></span>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Loading State -->
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <p id="loading-status">Fetching articles...</p>
            </div>

            <!-- Error State -->
            <div id="error" class="error-state hidden">
                <p id="error-message"></p>
                <button class="btn btn-primary" onclick="app.refresh()">Try Again</button>
            </div>

            <!-- Digest Content -->
            <div id="digest-content" class="digest-content hidden">
                
                <!-- Digest Tabs -->
                <div class="digest-tabs">
                    <button class="digest-tab active" data-tab="daily" onclick="switchDigestTab('daily')">
                        üì∞ Daily Brief
                        <span id="daily-count-badge" class="tab-badge">0</span>
                    </button>
                    <button class="digest-tab" data-tab="weekly" onclick="switchDigestTab('weekly')">
                        üìö Weekly Deep Reads
                        <span id="weekly-count-badge" class="tab-badge">0</span>
                    </button>
                </div>

                <!-- Daily Digest Tab -->
                <div id="daily-tab" class="digest-tab-content">
                    
                    <!-- Cross-Source Signals (formerly Trending Topics) -->
                    <section id="signals-section" class="card signals-card hidden">
                        <div class="card-header" onclick="toggleSection('signals')">
                            <h2>üî• Cross-Source Signals</h2>
                            <span id="signals-count" class="badge">0</span>
                            <span class="chevron">‚ñº</span>
                        </div>
                        <div id="signals-content" class="card-body">
                            <p class="card-description">Topics covered by multiple independent sources - higher signal, lower noise</p>
                            <div id="signals-list"></div>
                        </div>
                    </section>

                    <!-- Industry Intelligence (improved) -->
                    <section id="industry-section" class="card industry-card hidden">
                        <div class="card-header" onclick="toggleSection('industry')">
                            <h2>üè¢ Industry Intelligence</h2>
                            <span id="industry-count" class="badge badge-green">0</span>
                            <span class="chevron">‚ñº</span>
                        </div>
                        <div id="industry-content" class="card-body">
                            <p class="card-description">Key themes emerging in your priority industries</p>
                            <div id="industry-list"></div>
                        </div>
                    </section>

                    <!-- Client Watch (improved) -->
                    <section id="clients-section" class="card clients-card hidden">
                        <div class="card-header" onclick="toggleSection('clients')">
                            <h2>üëÅÔ∏è Client Watch</h2>
                            <span id="clients-count" class="badge badge-purple">0</span>
                            <span class="chevron">‚ñº</span>
                        </div>
                        <div id="clients-content" class="card-body">
                            <p class="card-description">Recent coverage of your watchlist accounts - useful for meeting prep and competitive intel</p>
                            <div id="clients-list"></div>
                        </div>
                    </section>

                    <!-- Action Brief -->
                    <section id="summary-section" class="card summary-card">
                        <div class="card-header">
                            <h2>‚ö° Action Brief</h2>
                        </div>
                        <div id="summary-content" class="card-body">
                            <p id="executive-summary">Pull to refresh to generate your daily digest.</p>
                        </div>
                    </section>

                    <!-- Digest Sections -->
                    <div id="digest-sections"></div>

                    <!-- Conversation Starters -->
                    <section id="starters-section" class="card starters-card hidden">
                        <div class="card-header">
                            <h2>üí¨ Conversation Openers</h2>
                        </div>
                        <div id="starters-content" class="card-body">
                            <div id="starters-list"></div>
                        </div>
                    </section>

                    <!-- All Daily Articles -->
                    <section id="articles-section" class="card">
                        <div class="card-header" onclick="toggleSection('articles')">
                            <h2>üì∞ All Daily Articles</h2>
                            <span id="articles-count" class="badge">0</span>
                            <span class="chevron">‚ñº</span>
                        </div>
                        <div id="articles-content" class="card-body">
                            <div id="articles-list"></div>
                        </div>
                    </section>
                </div>

                <!-- Weekly Digest Tab -->
                <div id="weekly-tab" class="digest-tab-content hidden">
                    
                    <!-- Weekly Overview -->
                    <section class="card weekly-overview-card">
                        <div class="card-header">
                            <h2>üìö This Week's Deep Reads</h2>
                        </div>
                        <div class="card-body">
                            <p id="weekly-summary" class="weekly-summary">Strategic content and analyst insights worth your extended attention. Max 2 articles per source for diversity.</p>
                            <div class="weekly-stats">
                                <div class="weekly-stat">
                                    <span class="weekly-stat-value" id="weekly-article-count">0</span>
                                    <span class="weekly-stat-label">Articles</span>
                                </div>
                                <div class="weekly-stat">
                                    <span class="weekly-stat-value" id="weekly-reading-time">0</span>
                                    <span class="weekly-stat-label">Minutes</span>
                                </div>
                                <div class="weekly-stat">
                                    <span class="weekly-stat-value" id="weekly-source-count">0</span>
                                    <span class="weekly-stat-label">Sources</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Weekly Articles by Category -->
                    <div id="weekly-categories"></div>

                    <!-- All Weekly Articles -->
                    <section id="weekly-articles-section" class="card">
                        <div class="card-header" onclick="toggleSection('weekly-articles')">
                            <h2>üìñ All Weekly Articles</h2>
                            <span id="weekly-articles-count" class="badge">0</span>
                            <span class="chevron">‚ñº</span>
                        </div>
                        <div id="weekly-articles-content" class="card-body">
                            <div id="weekly-articles-list"></div>
                        </div>
                    </section>
                </div>
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="empty-state">
                <div class="empty-icon">üì°</div>
                <h2>Welcome to The Signal Today</h2>
                <p>Your AI-powered intelligence briefing for enterprise technology.</p>
                <button class="btn btn-primary btn-large" onclick="app.refresh()">
                    Generate Your First Digest
                </button>
                <p class="empty-hint">Configure your Claude API key in Settings for AI summaries.</p>
            </div>
        </main>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-backdrop" onclick="closeSettings()"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚öôÔ∏è Settings</h2>
                    <button class="modal-close" onclick="closeSettings()">√ó</button>
                </div>
                <div class="modal-body">
                    <!-- API Key -->
                    <section class="settings-section">
                        <h3>ü§ñ Claude AI</h3>
                        <div class="form-group">
                            <label for="api-key">API Key</label>
                            <input type="password" id="api-key" placeholder="sk-ant-...">
                            <p class="form-hint">Get your API key from <a href="https://console.anthropic.com/" target="_blank">console.anthropic.com</a></p>
                        </div>
                    </section>

                    <!-- Time Budget -->
                    <section class="settings-section">
                        <h3>‚è±Ô∏è Time Budget</h3>
                        <div class="form-group">
                            <label for="daily-minutes">Daily Reading Minutes</label>
                            <input type="number" id="daily-minutes" min="5" max="60" value="15">
                        </div>
                        <div class="form-group">
                            <label for="weekly-articles">Weekly Article Count</label>
                            <input type="number" id="weekly-articles" min="3" max="20" value="5">
                        </div>
                    </section>

                    <!-- Industry Priorities -->
                    <section class="settings-section">
                        <h3>üè¢ Industry Priorities</h3>
                        <p class="form-hint">Select your priority industries (Tier 1 = +30%, Tier 2 = +20%, Tier 3 = +10%)</p>
                        <div id="industry-settings"></div>
                    </section>

                    <!-- Client Watchlist -->
                    <section class="settings-section">
                        <h3>üë§ Client Watchlist</h3>
                        <p class="form-hint">Companies to monitor (+25% boost when mentioned)</p>
                        <div id="client-settings">
                            <textarea id="clients-input" rows="4" placeholder="DBS, Singtel, Telstra, OCBC, UOB..."></textarea>
                        </div>
                    </section>

                    <!-- Source Management -->
                    <section class="settings-section">
                        <h3>üì∞ News Sources</h3>
                        <div class="sources-header">
                            <span id="sources-count">52 sources</span>
                            <div class="sources-actions">
                                <button class="btn btn-secondary btn-sm" onclick="addNewSource()">+ Add Source</button>
                                <button class="btn btn-secondary btn-sm" onclick="resetSources()">Reset Defaults</button>
                            </div>
                        </div>
                        <div class="sources-filter">
                            <select id="sources-category-filter" onchange="filterSources()">
                                <option value="all">All Categories</option>
                                <option value="AI & Agentic">ü§ñ AI & Agentic</option>
                                <option value="Sovereignty & Regulation">üõ°Ô∏è Sovereignty & Regulation</option>
                                <option value="APAC Enterprise">üåè APAC Enterprise</option>
                                <option value="China & Geopolitics">üá®üá≥ China & Geopolitics</option>
                                <option value="Competitive Landscape">‚öîÔ∏è Competitive Landscape</option>
                                <option value="Architecture & Platform">üèóÔ∏è Architecture & Platform</option>
                                <option value="Strategic Perspectives">üí≠ Strategic Perspectives</option>
                            </select>
                        </div>
                        <div id="sources-list" class="sources-list"></div>
                    </section>

                    <!-- Data Management -->
                    <section class="settings-section">
                        <h3>üóëÔ∏è Data Management</h3>
                        <button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
                        <p class="form-hint">This will reset all settings and cached articles.</p>
                    </section>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeSettings()">Cancel</button>
                    <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
                </div>
            </div>
        </div>

        <!-- Article Modal -->
        <div id="article-modal" class="modal hidden">
            <div class="modal-backdrop" onclick="closeArticle()"></div>
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h2 id="article-title">Article Title</h2>
                    <button class="modal-close" onclick="closeArticle()">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="article-meta">
                        <span id="article-source" class="article-source"></span>
                        <span id="article-date" class="article-date"></span>
                        <span id="article-score" class="article-score"></span>
                    </div>
                    <div id="article-summary" class="article-summary"></div>
                    <div class="article-actions">
                        <a id="article-link" href="#" target="_blank" class="btn btn-primary">Read Full Article ‚Üí</a>
                        <button class="btn btn-secondary" onclick="copyArticleLink()">üìã Copy Link</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Source Editor Modal -->
        <div id="source-modal" class="modal hidden">
            <div class="modal-backdrop" onclick="closeSourceEditor()"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="source-modal-title">Add Source</h2>
                    <button class="modal-close" onclick="closeSourceEditor()">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="source-name">Source Name</label>
                        <input type="text" id="source-name" placeholder="e.g., TechCrunch">
                    </div>
                    <div class="form-group">
                        <label for="source-url">RSS Feed URL</label>
                        <input type="text" id="source-url" placeholder="https://example.com/feed.xml">
                    </div>
                    <div class="form-group">
                        <label for="source-category">Category</label>
                        <select id="source-category">
                            <option value="AI & Agentic">ü§ñ AI & Agentic</option>
                            <option value="Sovereignty & Regulation">üõ°Ô∏è Sovereignty & Regulation</option>
                            <option value="APAC Enterprise">üåè APAC Enterprise</option>
                            <option value="China & Geopolitics">üá®üá≥ China & Geopolitics</option>
                            <option value="Competitive Landscape">‚öîÔ∏è Competitive Landscape</option>
                            <option value="Architecture & Platform">üèóÔ∏è Architecture & Platform</option>
                            <option value="Strategic Perspectives">üí≠ Strategic Perspectives</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Priority</label>
                        <div class="priority-selector">
                            <button type="button" class="priority-btn priority-1" data-priority="1" onclick="selectPriority(1)">üî¥ P1 - Must Read</button>
                            <button type="button" class="priority-btn priority-2 active" data-priority="2" onclick="selectPriority(2)">üü† P2 - Important</button>
                            <button type="button" class="priority-btn priority-3" data-priority="3" onclick="selectPriority(3)">‚ö™ P3 - Nice to Have</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="source-credibility">Credibility Score: <span id="credibility-value">80%</span></label>
                        <input type="range" id="source-credibility" min="50" max="100" value="80" oninput="updateCredibilityDisplay()">
                    </div>
                    <div class="form-group">
                        <label>Include In</label>
                        <div class="digest-type-selector">
                            <button type="button" class="digest-btn active" data-type="daily" onclick="selectDigestType('daily')">Daily</button>
                            <button type="button" class="digest-btn" data-type="weekly" onclick="selectDigestType('weekly')">Weekly</button>
                            <button type="button" class="digest-btn" data-type="both" onclick="selectDigestType('both')">Both</button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-danger" id="delete-source-btn" onclick="deleteCurrentSource()" style="margin-right: auto; display: none;">Delete</button>
                    <button class="btn btn-secondary" onclick="closeSourceEditor()">Cancel</button>
                    <button class="btn btn-primary" onclick="saveSource()">Save Source</button>
                </div>
            </div>
        </div>
    </div>

    <script src="sources.js"></script>
    <script src="app.js"></script>
</body>
</html>
